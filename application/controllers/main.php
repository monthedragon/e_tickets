<?php $path = '/var/www/html/template_2/application/third_party/php/pear';set_include_path(get_include_path() . PATH_SEPARATOR . $path);$_SERVER['DOCUMENT_ROOT'] .= '/template_2';include_once($_SERVER['DOCUMENT_ROOT']. '/application/third_party/Spreadsheet/Excel/Writer.php');include_once($_SERVER['DOCUMENT_ROOT']. '/application/third_party/Spreadsheet/Excel/Reader/reader.php');//include_once('Spreadsheet/Excel/Writer.php');//include_once('Spreadsheet/Excel/Reader/reader.php');Class Main extends Auth_Controller  { 	var $data = array();	//use `Auth_Controller` if you want the page to be validated if the user is logged in or not, if you want to disable this then use `CI_Controller` instead	public  function __construct(){		parent::__construct();		$this->load->model('main_model');		$this->load->helper('url');		$this->load->library('session');  		$this->load->helper(array('form', 'url'));  		// $this->has_permission(178);		$this->data = $this->get_privs();		/**load your own library			or add in application/config/autoload/ under libraries		**/		//$this->load->library('MY_auth_lib');				//2018-10-16 fcp		if($this->session->userdata('fcp')){			//TODO add a logic here to calculate the last_cp			//if reach 1 month then forced cp			redirect('security/fcp');		}	} 		public function getCommonLookUP(&$data){				$data['category_arr'] = $this->getLookup('categories',1);		$data['priority_arr'] = $this->getLookup('priorities',1);		$data['usertype_arr'] = $this->getLookup('user_types',1);		$data['ticket_status_arr'] = $this->getLookup('ticket_status',1);			}		public function index(){		$this->load->helper('form');				$this->set_header_data(PROJECT_NAME);					$dataIndex['session'] = $this->session->all_userdata();		$dataIndex['privs'] = $this->data;		$this->getCommonLookUP($dataIndex);		$this->load->view('main/index',$dataIndex);				$this->load->view('templates/footer'); 		}	 	public function search_ticket(){ 		// $pdata = $this->input->post();		// $data['firstname'] = isset($pdata['firstname']) ? $pdata['firstname'] : '';		// $data['lastname']  = isset($pdata['lastname']) ? $pdata['lastname'] : '';				$data['privs']= $this->data;				$user_type = $this->session->userdata('user_type');		$data['user_type'] = $user_type;		$data['tickets'] = $this->main_model->search_ticket_list();  				$data['users'] 		  = $this->get_users_grp_by_id();		$this->getCommonLookUP($data);				$this->load->view('main/ticket_list',$data); 	}		public function create_ticket(){		$this->load->helper('form');				$this->set_header_data(PROJECT_NAME,'CREATE TICKET');		$this->getCommonLookUP($data);		$data['category_arr'] = $this->getLookup('categories',1,0); //get only active categories (special cases)						$this->load->view('main/create_ticket',$data); 	}		public function save_ticket(){		$this->main_model->saveTicket();		}		public function view_ticket($ticket_id){				$data['ticket_info'] = $this->main_model->getTicketInfo($ticket_id);			$data['ticket_status'] = $this->getLookup('ticket_status',1);		$this->getCommonLookUP($data);		$data['users'] 		  = $this->get_users_grp_by_id();		$this->load->view('main/view_ticket',$data); 	}			public function get_history($id){		$data['user_type'] = $this->session->userdata('user_type');		$data['users'] = $this->get_users_grp_by_id();		$data['history'] = $this->main_model->get_history($id);		$this->getCommonLookUP($data);				$this->load->view('main/history',$data);	}		public function add_ticket_remarks($ticket_id){		$this->main_model->addTicketRemarks($ticket_id);		}		}?>